"use strict";(self.webpackChunkneat_admin_template=self.webpackChunkneat_admin_template||[]).push([["1321"],{22815(e,n,s){s.r(n)},96816(e,n,s){s.r(n),s.d(n,{default:()=>w});var t=s(74848),r=s(96540),l=s(26149),i=s(12229),c=s(17125),a=s(40244),o=s(99373),d=s(16629),h=s(36813),u=s(58607),x=s(59330),j=s(41879),g=s(6236),y=s(94889);s(22815);let{TextArea:m}=l.A,{Title:A,Paragraph:p,Text:v}=i.A,w=()=>{let[e,n]=(0,r.useState)([]),[s,i]=(0,r.useState)(""),[w,f]=(0,r.useState)([]),[C,B]=(0,r.useState)(""),[I,$]=(0,r.useState)(0),[k,b]=(0,r.useState)("æœªç™»å½•"),[S]=(0,r.useState)(()=>Math.random().toString(36).substr(2,9)),M=(0,r.useRef)(null),D=(0,r.useRef)(null),P=(0,r.useRef)(null),T=(0,r.useRef)(null),N=e=>{n(n=>[...n,`[${new Date().toLocaleTimeString()}] ${e}`])};(0,r.useEffect)(()=>{if(!("BroadcastChannel"in window)){N("âŒ æµè§ˆå™¨ä¸æ”¯æŒ BroadcastChannel API"),c.Ay.error("æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒ BroadcastChannel API");return}return N(`ðŸ†” å½“å‰æ ‡ç­¾é¡µ ID: ${S}`),N("âœ… BroadcastChannel API å·²å°±ç»ª"),R(),E(),q(),z(),N("\uD83D\uDE80 æ‰€æœ‰é¢‘é“å·²è‡ªåŠ¨åˆå§‹åŒ–"),()=>{var e,n,s,t;null==(e=M.current)||e.close(),null==(n=D.current)||n.close(),null==(s=P.current)||s.close(),null==(t=T.current)||t.close()}},[S]);let R=()=>{if(M.current)return;let e=new BroadcastChannel("messaging-channel");M.current=e,e.onmessage=e=>{let{tabId:n,message:s}=e.data;n!==S&&(f(e=>[...e,`[æ¥è‡ªæ ‡ç­¾ ${n}]: ${s}`]),N(`ðŸ“¨ æ”¶åˆ°æ¶ˆæ¯: ${s}`))},e.onmessageerror=e=>{N(`âŒ æ¶ˆæ¯é”™è¯¯: ${e}`)},N("âœ… æ¶ˆæ¯é¢‘é“å·²åˆå§‹åŒ–")},_=()=>{if(!M.current)return void c.Ay.warning("è¯·å…ˆåˆå§‹åŒ–æ¶ˆæ¯é¢‘é“");if(!s.trim())return void c.Ay.warning("è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹");let e={tabId:S,message:s,timestamp:Date.now()};M.current.postMessage(e),N(`ðŸ“¤ å‘é€æ¶ˆæ¯: ${s}`),i(""),c.Ay.success("æ¶ˆæ¯å·²å‘é€åˆ°æ‰€æœ‰æ ‡ç­¾é¡µ")},E=()=>{if(D.current)return;let e=new BroadcastChannel("sync-channel");D.current=e,e.onmessage=n=>{let{type:s,data:t,tabId:r}=n.data;r!==S&&("sync-request"===s?(N(`ðŸ“¥ æ”¶åˆ°åŒæ­¥è¯·æ±‚æ¥è‡ªæ ‡ç­¾ ${r}`),e.postMessage({type:"sync-response",data:C,tabId:S})):"sync-response"===s?(N(`ðŸ“¥ æ”¶åˆ°åŒæ­¥æ•°æ®: ${t}`),B(t),c.Ay.success("æ•°æ®å·²åŒæ­¥")):"data-update"===s&&(N(`ðŸ“¥ æ”¶åˆ°æ•°æ®æ›´æ–°: ${t}`),B(t),c.Ay.info("æ•°æ®å·²æ›´æ–°")))},N("âœ… åŒæ­¥é¢‘é“å·²åˆå§‹åŒ–")},q=()=>{if(P.current)return;let e=new BroadcastChannel("notification-channel");P.current=e,e.onmessage=e=>{let{type:n,title:s,content:r,tabId:l}=e.data;l!==S&&"notification"===n&&($(e=>e+1),N(`ðŸ”” æ”¶åˆ°é€šçŸ¥: ${s}`),c.Ay.info({content:(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:s}),(0,t.jsx)("div",{children:r})]}),duration:3}))},N("âœ… é€šçŸ¥é¢‘é“å·²åˆå§‹åŒ–")},z=()=>{if(T.current)return;let e=new BroadcastChannel("auth-channel");T.current=e,e.onmessage=e=>{let{type:n,tabId:s}=e.data;s!==S&&("login"===n?(b("å·²ç™»å½•"),N(`ðŸ” æ£€æµ‹åˆ°ç™»å½•æ“ä½œæ¥è‡ªæ ‡ç­¾ ${s}`),c.Ay.success("å·²åœ¨å…¶ä»–æ ‡ç­¾é¡µç™»å½•")):"logout"===n?(b("æœªç™»å½•"),N(`ðŸ”“ æ£€æµ‹åˆ°ç™»å‡ºæ“ä½œæ¥è‡ªæ ‡ç­¾ ${s}`),c.Ay.warning("å·²åœ¨å…¶ä»–æ ‡ç­¾é¡µç™»å‡º")):"token-refresh"===n&&(N(`ðŸ”„ Token å·²åˆ·æ–°æ¥è‡ªæ ‡ç­¾ ${s}`),c.Ay.info("è®¤è¯ä»¤ç‰Œå·²æ›´æ–°")))},N("âœ… è®¤è¯é¢‘é“å·²åˆå§‹åŒ–")};return(0,t.jsxs)("div",{className:"broadcast-channel-demo",children:[(0,t.jsx)(A,{level:2,children:"BroadcastChannel API ç¤ºä¾‹"}),(0,t.jsx)(p,{children:(0,t.jsx)(v,{type:"secondary",children:"BroadcastChannel API å…è®¸åŒæºçš„ä¸åŒæµè§ˆä¸Šä¸‹æ–‡ï¼ˆæ ‡ç­¾é¡µã€çª—å£ã€iframeï¼‰ä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚ æ‰“å¼€å¤šä¸ªæ ‡ç­¾é¡µæ¥æµ‹è¯•è·¨æ ‡ç­¾é¡µé€šä¿¡æ•ˆæžœã€‚"})}),(0,t.jsx)(a.A,{message:"ä½¿ç”¨æç¤º",description:(0,t.jsxs)("div",{children:[(0,t.jsxs)("p",{children:["â€¢ ",(0,t.jsx)("strong",{children:"é¡µé¢å·²è‡ªåŠ¨åˆå§‹åŒ–æ‰€æœ‰é¢‘é“"}),"ï¼Œå¯ç›´æŽ¥æµ‹è¯•è·¨æ ‡ç­¾é¡µé€šä¿¡"]}),(0,t.jsxs)("p",{children:["â€¢ å½“å‰æ ‡ç­¾é¡µ ID: ",(0,t.jsx)(o.A,{color:"blue",children:S})]}),(0,t.jsx)("p",{children:"â€¢ åœ¨æ–°æ ‡ç­¾é¡µä¸­æ‰“å¼€æ­¤é¡µé¢ï¼Œä¸¤ä¸ªæ ‡ç­¾é¡µå¯ä»¥äº’ç›¸é€šä¿¡"}),(0,t.jsx)("p",{children:"â€¢ BroadcastChannel ä»…åœ¨åŒæºé¡µé¢é—´å·¥ä½œï¼ˆç›¸åŒåè®®ã€åŸŸåã€ç«¯å£ï¼‰"})]}),type:"info",showIcon:!0,style:{marginBottom:24}}),(0,t.jsx)(d.A,{title:"åœºæ™¯ 1: åŸºç¡€è·¨æ ‡ç­¾é¡µæ¶ˆæ¯ä¼ é€’",style:{marginBottom:24},children:(0,t.jsxs)(h.A,{direction:"vertical",style:{width:"100%"},children:[(0,t.jsx)(a.A,{message:"é€‚ç”¨åœºæ™¯",description:"ç”¨äºŽæ ‡ç­¾é¡µä¹‹é—´å‘é€ç®€å•æ¶ˆæ¯ï¼Œå¦‚é€šçŸ¥ã€æé†’ã€å®žæ—¶æ›´æ–°ç­‰ã€‚é¢‘é“å·²è‡ªåŠ¨åˆå§‹åŒ–ï¼Œå¯ç›´æŽ¥å‘é€æ¶ˆæ¯ã€‚",type:"success",showIcon:!0}),(0,t.jsxs)("div",{children:[(0,t.jsx)(m,{value:s,onChange:e=>i(e.target.value),placeholder:"è¾“å…¥è¦å‘é€çš„æ¶ˆæ¯...",rows:3,onPressEnter:e=>{e.shiftKey||(e.preventDefault(),_())}}),(0,t.jsx)(u.Ay,{type:"primary",icon:(0,t.jsx)(j.A,{}),onClick:_,style:{marginTop:8},children:"å‘é€æ¶ˆæ¯"})]}),w.length>0&&(0,t.jsx)(d.A,{size:"small",title:"æ”¶åˆ°çš„æ¶ˆæ¯",children:w.map((e,n)=>(0,t.jsx)("div",{className:"received-message",children:e},n))})]})}),(0,t.jsx)(d.A,{title:"åœºæ™¯ 2: æ•°æ®åŒæ­¥",style:{marginBottom:24},children:(0,t.jsxs)(h.A,{direction:"vertical",style:{width:"100%"},children:[(0,t.jsx)(a.A,{message:"é€‚ç”¨åœºæ™¯",description:"å¤šæ ‡ç­¾é¡µä¹‹é—´åŒæ­¥åº”ç”¨çŠ¶æ€ã€ç”¨æˆ·è®¾ç½®ã€è´­ç‰©è½¦å†…å®¹ç­‰æ•°æ®ã€‚é¢‘é“å·²è‡ªåŠ¨åˆå§‹åŒ–ã€‚",type:"success",showIcon:!0}),(0,t.jsx)(h.A,{children:(0,t.jsx)(u.Ay,{type:"primary",icon:(0,t.jsx)(g.A,{}),onClick:()=>{D.current?(D.current.postMessage({type:"sync-request",tabId:S}),N("\uD83D\uDCE4 è¯·æ±‚æ•°æ®åŒæ­¥")):c.Ay.warning("è¯·å…ˆåˆå§‹åŒ–åŒæ­¥é¢‘é“")},children:"è¯·æ±‚åŒæ­¥æ•°æ®"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v,{strong:!0,children:"å½“å‰åŒæ­¥æ•°æ®ï¼š"}),(0,t.jsx)(l.A,{value:C,onChange:e=>{var n;B(n=e.target.value),D.current&&(D.current.postMessage({type:"data-update",data:n,tabId:S}),N(`ðŸ“¤ å¹¿æ’­æ•°æ®æ›´æ–°: ${n}`))},placeholder:"è¾“å…¥æ•°æ®ï¼ˆå°†è‡ªåŠ¨åŒæ­¥åˆ°å…¶ä»–æ ‡ç­¾é¡µï¼‰",style:{marginTop:8}})]})]})}),(0,t.jsx)(d.A,{title:"åœºæ™¯ 3: å®žæ—¶é€šçŸ¥ç³»ç»Ÿ",style:{marginBottom:24},children:(0,t.jsxs)(h.A,{direction:"vertical",style:{width:"100%"},children:[(0,t.jsx)(a.A,{message:"é€‚ç”¨åœºæ™¯",description:"è·¨æ ‡ç­¾é¡µæŽ¨é€é€šçŸ¥ã€ç³»ç»Ÿæ¶ˆæ¯ã€å®žæ—¶æé†’ç­‰ã€‚é¢‘é“å·²è‡ªåŠ¨åˆå§‹åŒ–ã€‚",type:"success",showIcon:!0}),(0,t.jsxs)(h.A,{children:[(0,t.jsx)(u.Ay,{type:"primary",icon:(0,t.jsx)(y.A,{}),onClick:()=>{if(!P.current)return void c.Ay.warning("è¯·å…ˆåˆå§‹åŒ–é€šçŸ¥é¢‘é“");let e={type:"notification",title:"æ–°æ¶ˆæ¯",content:`æ¥è‡ªæ ‡ç­¾ ${S} çš„é€šçŸ¥ - ${new Date().toLocaleTimeString()}`,tabId:S};P.current.postMessage(e),N("\uD83D\uDCE4 å‘é€é€šçŸ¥åˆ°æ‰€æœ‰æ ‡ç­¾é¡µ")},children:"å‘é€é€šçŸ¥"}),(0,t.jsx)(x.A,{count:I,showZero:!0,children:(0,t.jsx)(o.A,{children:"é€šçŸ¥è®¡æ•°"})})]})]})}),(0,t.jsx)(d.A,{title:"åœºæ™¯ 4: è®¤è¯çŠ¶æ€åŒæ­¥",style:{marginBottom:24},children:(0,t.jsxs)(h.A,{direction:"vertical",style:{width:"100%"},children:[(0,t.jsx)(a.A,{message:"é€‚ç”¨åœºæ™¯",description:"åŒæ­¥ç™»å½•/ç™»å‡ºçŠ¶æ€ã€Token åˆ·æ–°ã€ä¼šè¯è¿‡æœŸæé†’ç­‰ã€‚é¢‘é“å·²è‡ªåŠ¨åˆå§‹åŒ–ã€‚",type:"success",showIcon:!0}),(0,t.jsx)(h.A,{children:(0,t.jsxs)("div",{children:["å½“å‰çŠ¶æ€: ",(0,t.jsx)(o.A,{color:"å·²ç™»å½•"===k?"green":void 0,children:k})]})}),(0,t.jsxs)(h.A,{children:[(0,t.jsx)(u.Ay,{onClick:()=>{T.current?(b("å·²ç™»å½•"),T.current.postMessage({type:"login",status:"logged-in",tabId:S,timestamp:Date.now()}),N("\uD83D\uDD10 æ¨¡æ‹Ÿç™»å½•å¹¶å¹¿æ’­çŠ¶æ€"),c.Ay.success("ç™»å½•æˆåŠŸ")):c.Ay.warning("è¯·å…ˆåˆå§‹åŒ–è®¤è¯é¢‘é“")},children:"æ¨¡æ‹Ÿç™»å½•"}),(0,t.jsx)(u.Ay,{onClick:()=>{T.current?(b("æœªç™»å½•"),T.current.postMessage({type:"logout",status:"logged-out",tabId:S,timestamp:Date.now()}),N("\uD83D\uDD13 æ¨¡æ‹Ÿç™»å‡ºå¹¶å¹¿æ’­çŠ¶æ€"),c.Ay.info("å·²ç™»å‡º")):c.Ay.warning("è¯·å…ˆåˆå§‹åŒ–è®¤è¯é¢‘é“")},children:"æ¨¡æ‹Ÿç™»å‡º"})]})]})}),(0,t.jsx)(d.A,{title:"æœ€ä½³å®žè·µä¸Žæ³¨æ„äº‹é¡¹",style:{marginBottom:24},children:(0,t.jsxs)(h.A,{direction:"vertical",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(v,{strong:!0,children:"âœ… ä¼˜ç‚¹ï¼š"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"ç®€å•æ˜“ç”¨çš„ API"}),(0,t.jsx)("li",{children:"æ”¯æŒè·¨æ ‡ç­¾é¡µã€iframeã€Worker é€šä¿¡"}),(0,t.jsx)("li",{children:"è‡ªåŠ¨å¤„ç†åºåˆ—åŒ–/ååºåˆ—åŒ–"}),(0,t.jsx)("li",{children:"æ”¯æŒä¼ è¾“å¤æ‚å¯¹è±¡ï¼ˆé€šè¿‡ç»“æž„åŒ–å…‹éš†ç®—æ³•ï¼‰"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v,{strong:!0,children:"âš ï¸ é™åˆ¶ï¼š"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"ä»…é™åŒæºé¡µé¢ï¼ˆç›¸åŒåè®®ã€åŸŸåã€ç«¯å£ï¼‰"}),(0,t.jsx)("li",{children:"ä¸æ”¯æŒè·¨åŸŸé€šä¿¡"}),(0,t.jsx)("li",{children:"æ¶ˆæ¯ä¸ä¿è¯åˆ°è¾¾é¡ºåº"}),(0,t.jsx)("li",{children:"ä¸æ”¯æŒè¯·æ±‚-å“åº”æ¨¡å¼ï¼ˆéœ€è‡ªè¡Œå®žçŽ°ï¼‰"}),(0,t.jsx)("li",{children:"IE æµè§ˆå™¨ä¸æ”¯æŒ"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v,{strong:!0,children:"\uD83D\uDEE1ï¸ å®‰å…¨å»ºè®®ï¼š"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"éªŒè¯æŽ¥æ”¶çš„æ¶ˆæ¯æ¥æºå’Œå†…å®¹"}),(0,t.jsx)("li",{children:"é¿å…ä¼ è¾“æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç ï¼‰"}),(0,t.jsx)("li",{children:"ä½¿ç”¨ç±»åž‹æ£€æŸ¥ç¡®ä¿æ•°æ®ç»“æž„æ­£ç¡®"}),(0,t.jsx)("li",{children:"åŠæ—¶å…³é—­ä¸å†ä½¿ç”¨çš„é¢‘é“"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(v,{strong:!0,children:"\uD83D\uDD27 ä½¿ç”¨åœºæ™¯ï¼š"}),(0,t.jsxs)("ul",{children:[(0,t.jsx)("li",{children:"å¤šæ ‡ç­¾é¡µçŠ¶æ€åŒæ­¥ï¼ˆè´­ç‰©è½¦ã€ç”¨æˆ·è®¾ç½®ï¼‰"}),(0,t.jsx)("li",{children:"å®žæ—¶é€šçŸ¥ç³»ç»Ÿï¼ˆæ–°æ¶ˆæ¯ã€ç³»ç»Ÿå…¬å‘Šï¼‰"}),(0,t.jsx)("li",{children:"è®¤è¯çŠ¶æ€åŒæ­¥ï¼ˆç™»å½•/ç™»å‡ºã€Token åˆ·æ–°ï¼‰"}),(0,t.jsx)("li",{children:"ååŒç¼–è¾‘é¢„è§ˆï¼ˆä¸€ä¸ªæ ‡ç­¾ç¼–è¾‘ï¼Œå¦ä¸€ä¸ªå®žæ—¶é¢„è§ˆï¼‰"}),(0,t.jsx)("li",{children:"æ•°æ®ç¼“å­˜å¤±æ•ˆé€šçŸ¥"})]})]})]})}),(0,t.jsx)(d.A,{title:"ä»£ç ç¤ºä¾‹",style:{marginBottom:24},children:(0,t.jsx)("pre",{className:"code-block",children:`// åˆ›å»ºé¢‘é“
const channel = new BroadcastChannel('my-channel');

// ç›‘å¬æ¶ˆæ¯
channel.onmessage = (event) => {
  console.log('æ”¶åˆ°æ¶ˆæ¯:', event.data);
};

// å‘é€æ¶ˆæ¯
channel.postMessage({ type: 'update', data: 'Hello' });

// å…³é—­é¢‘é“
channel.close();

// é”™è¯¯å¤„ç†
channel.onmessageerror = (event) => {
  console.error('æ¶ˆæ¯é”™è¯¯:', event);
};`})}),(0,t.jsx)(d.A,{title:"æ“ä½œæ—¥å¿—",extra:(0,t.jsx)(u.Ay,{size:"small",onClick:()=>{n([])},children:"æ¸…é™¤æ—¥å¿—"}),children:(0,t.jsx)("div",{className:"logs-container",children:0===e.length?(0,t.jsx)(v,{type:"secondary",children:"æš‚æ— æ—¥å¿—"}):e.map((e,n)=>(0,t.jsx)("div",{className:"log-item",children:e},n))})})]})}}}]);