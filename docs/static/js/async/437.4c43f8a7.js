"use strict";(self.webpackChunkant_admin_template=self.webpackChunkant_admin_template||[]).push([["437"],{18363(e,t,s){s.r(t)},50420(e,t,s){s.r(t),s.d(t,{default:()=>j});var i=s(74848),l=s(96540),a=s(68874),r=s(99373),n=s(36813),o=s(58607),d=s(55021),m=s(98254),c=s(17481),p=s(26149),u=s(84713),y=s(98335),h=s(56304),g=s(26385),x=s(46029),k=s(38623),A=s(53054);s(18363);let j=()=>{let{t:e}=(0,A.Bd)(),[t]=a.A.useForm(),[s,j]=(0,l.useState)([{id:"1",name:"超级管理员",code:"super_admin",description:"拥有系统所有权限",status:"active",userCount:2,createdAt:"2024-01-01",permissions:["user:view","user:create","user:update","user:delete","role:view"]},{id:"2",name:"管理员",code:"admin",description:"拥有系统大部分权限",status:"active",userCount:5,createdAt:"2024-01-02",permissions:["user:view","user:create","user:update","role:view"]},{id:"3",name:"普通用户",code:"user",description:"基础权限",status:"active",userCount:100,createdAt:"2024-01-03",permissions:["user:view"]}]),[C,v]=(0,l.useState)(!1),[w,S]=(0,l.useState)(!1),[F,f]=(0,l.useState)(null),[I,_]=(0,l.useState)([]),[T,b]=(0,l.useState)(!1),D=[{title:e("pages.system:roleColName"),dataIndex:"name",key:"name",width:150},{title:e("pages.system:roleColCode"),dataIndex:"code",key:"code",width:150,render:e=>(0,i.jsx)(r.A,{children:e})},{title:e("pages.system:roleColDescription"),dataIndex:"description",key:"description"},{title:e("pages.system:roleColStatus"),dataIndex:"status",key:"status",width:100,render:t=>(0,i.jsx)(r.A,{className:`role-status-${t}`,children:"active"===t?e("pages.system:roleStatusActive"):e("pages.system:roleStatusInactive")})},{title:e("pages.system:roleColUserCount"),dataIndex:"userCount",key:"userCount",width:100},{title:e("pages.system:roleColCreatedAt"),dataIndex:"createdAt",key:"createdAt",width:120},{title:e("pages.system:roleColActions"),key:"actions",width:200,fixed:"right",render:(t,s)=>(0,i.jsxs)(n.A,{children:[(0,i.jsx)(o.Ay,{type:"link",size:"small",icon:(0,i.jsx)(h.A,{}),onClick:()=>P(s),children:e("pages.system:roleBtnPermission")}),(0,i.jsx)(o.Ay,{type:"link",size:"small",icon:(0,i.jsx)(g.A,{}),onClick:()=>N(s),children:e("pages.system:roleBtnEdit")}),(0,i.jsx)(d.A,{title:e("pages.system:roleMsgDeleteConfirm"),onConfirm:()=>z(s.id),okText:e("common:yes"),cancelText:e("common:no"),children:(0,i.jsx)(o.Ay,{type:"link",size:"small",danger:!0,icon:(0,i.jsx)(x.A,{}),children:e("pages.system:roleBtnDelete")})})]})}],N=e=>{f(e),t.setFieldsValue(e),v(!0)},z=e=>{j(s.filter(t=>t.id!==e))},P=e=>{f(e),_(e.permissions),S(!0)},B=async()=>{try{let e=await t.validateFields();if(b(!0),F)j(s.map(t=>t.id===F.id?{...t,...e}:t));else{let t={id:Date.now().toString(),...e,userCount:0,createdAt:new Date().toISOString().split("T")[0],permissions:[]};j([...s,t])}v(!1),t.resetFields()}catch(e){console.error("Validation failed:",e)}finally{b(!1)}};return(0,i.jsxs)("div",{className:"role-management",children:[(0,i.jsxs)("div",{className:"role-management__header",children:[(0,i.jsx)("h2",{children:e("pages.system:roleTitle")}),(0,i.jsx)(o.Ay,{type:"primary",icon:(0,i.jsx)(k.A,{}),onClick:()=>{f(null),t.resetFields(),v(!0)},children:e("pages.system:roleBtnAdd")})]}),(0,i.jsx)(m.A,{scroll:{x:"max-content"},columns:D,dataSource:s,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,showTotal:e=>`共 ${e} 条`}}),(0,i.jsx)(c.A,{title:F?e("pages.system:roleModalTitleEdit"):e("pages.system:roleModalTitleAdd"),open:C,onOk:B,onCancel:()=>v(!1),confirmLoading:T,width:600,children:(0,i.jsxs)(a.A,{form:t,layout:"vertical",children:[(0,i.jsx)(a.A.Item,{name:"name",label:e("pages.system:roleFormName"),rules:[{required:!0,message:e("pages.system:roleFormNameRequired")}],children:(0,i.jsx)(p.A,{placeholder:e("pages.system:roleFormNamePh")})}),(0,i.jsx)(a.A.Item,{name:"code",label:e("pages.system:roleFormCode"),rules:[{required:!0,message:e("pages.system:roleFormCodeRequired")},{pattern:/^[a-z_]+$/,message:e("pages.system:roleFormCodePattern")}],children:(0,i.jsx)(p.A,{placeholder:e("pages.system:roleFormCodePh"),disabled:!!F})}),(0,i.jsx)(a.A.Item,{name:"description",label:e("pages.system:roleFormDescription"),children:(0,i.jsx)(p.A.TextArea,{rows:3,placeholder:e("pages.system:roleFormDescriptionPh")})}),(0,i.jsx)(a.A.Item,{name:"status",label:e("pages.system:roleFormStatus"),initialValue:"active",children:(0,i.jsxs)(u.A,{children:[(0,i.jsx)(u.A.Option,{value:"active",children:e("pages.system:roleStatusActive")}),(0,i.jsx)(u.A.Option,{value:"inactive",children:e("pages.system:roleStatusInactive")})]})})]})}),(0,i.jsx)(c.A,{title:e("pages.system:rolePermissionTitle"),open:w,onOk:()=>{F&&(j(s.map(e=>e.id===F.id?{...e,permissions:I}:e)),S(!1))},onCancel:()=>S(!1),width:600,children:(0,i.jsxs)("div",{className:"role-management__permission",children:[(0,i.jsxs)("p",{children:['为角色 "',null==F?void 0:F.name,'" 分配权限：']}),(0,i.jsx)(y.A,{checkable:!0,defaultExpandAll:!0,treeData:[{key:"user",title:"用户管理",children:[{key:"user:view",title:"查看用户"},{key:"user:create",title:"创建用户"},{key:"user:update",title:"编辑用户"},{key:"user:delete",title:"删除用户"}]},{key:"role",title:"角色管理",children:[{key:"role:view",title:"查看角色"},{key:"role:create",title:"创建角色"},{key:"role:update",title:"编辑角色"},{key:"role:delete",title:"删除角色"}]},{key:"menu",title:"菜单管理",children:[{key:"menu:view",title:"查看菜单"},{key:"menu:create",title:"创建菜单"},{key:"menu:update",title:"编辑菜单"},{key:"menu:delete",title:"删除菜单"}]},{key:"permission",title:"权限管理",children:[{key:"permission:view",title:"查看权限"},{key:"permission:create",title:"创建权限"},{key:"permission:update",title:"编辑权限"},{key:"permission:delete",title:"删除权限"}]}],checkedKeys:I,onCheck:e=>{_(e)}})]})})]})}}}]);