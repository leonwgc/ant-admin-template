"use strict";(self.webpackChunkant_admin_template=self.webpackChunkant_admin_template||[]).push([["7314"],{23980(e,s,i){i.r(s)},14361(e,s,i){i.r(s),i.d(s,{default:()=>j});var t=i(74848),r=i(96540),a=i(68874),n=i(99373),o=i(36813),m=i(58607),l=i(55021),d=i(26149),p=i(7727),c=i(29522),u=i(17481),y=i(84713),h=i(4459),g=i(65797),x=i(61804),A=i(53054);i(23980);let j=()=>{let{t:e}=(0,A.Bd)(),[s]=a.A.useForm(),[i,j]=(0,r.useState)([{id:"1",code:"user:view",name:"查看用户",type:"page",module:"user",description:"查看用户列表和详情",createdAt:"2024-01-01"},{id:"2",code:"user:create",name:"创建用户",type:"button",module:"user",description:"创建新用户",createdAt:"2024-01-01"},{id:"3",code:"user:update",name:"编辑用户",type:"button",module:"user",description:"编辑用户信息",createdAt:"2024-01-01"},{id:"4",code:"user:delete",name:"删除用户",type:"button",module:"user",description:"删除用户",createdAt:"2024-01-01"},{id:"5",code:"role:view",name:"查看角色",type:"page",module:"role",description:"查看角色列表",createdAt:"2024-01-02"},{id:"6",code:"role:create",name:"创建角色",type:"button",module:"role",description:"创建新角色",createdAt:"2024-01-02"},{id:"7",code:"menu:view",name:"查看菜单",type:"page",module:"menu",description:"查看菜单列表",createdAt:"2024-01-03"},{id:"8",code:"api:user:list",name:"用户列表接口",type:"api",module:"user",description:"GET /api/users",createdAt:"2024-01-04"}]),[C,w]=(0,r.useState)(!1),[v,F]=(0,r.useState)(null),[b,k]=(0,r.useState)(!1),[T,f]=(0,r.useState)(""),N=i.reduce((e,s)=>{var i;let t=e.find(e=>e.module===s.module);return t?t.permissions.push(s):e.push({module:s.module,moduleName:{user:"用户管理",role:"角色管理",menu:"菜单管理",permission:"权限管理"}[i=s.module]||i,permissions:[s]}),e},[]).filter(e=>!T||e.permissions.some(e=>e.name.toLowerCase().includes(T.toLowerCase())||e.code.toLowerCase().includes(T.toLowerCase()))),S=[{title:e("pages.system:permissionColCode"),dataIndex:"code",key:"code",width:200,render:e=>(0,t.jsx)(n.A,{children:e})},{title:e("pages.system:permissionColName"),dataIndex:"name",key:"name",width:150},{title:e("pages.system:permissionColType"),dataIndex:"type",key:"type",width:100,render:s=>{let i={page:{text:e("pages.system:permissionTypePage"),className:"permission-type-page"},button:{text:e("pages.system:permissionTypeButton"),className:"permission-type-button"},api:{text:e("pages.system:permissionTypeApi"),className:"permission-type-api"}}[s];return(0,t.jsx)(n.A,{className:i.className,children:i.text})}},{title:e("pages.system:permissionColDescription"),dataIndex:"description",key:"description"},{title:e("pages.system:permissionColCreatedAt"),dataIndex:"createdAt",key:"createdAt",width:120},{title:e("pages.system:permissionColActions"),key:"actions",width:150,fixed:"right",render:(s,i)=>(0,t.jsxs)(o.A,{children:[(0,t.jsx)(m.Ay,{type:"link",size:"small",icon:(0,t.jsx)(h.A,{}),onClick:()=>I(i),children:e("pages.system:permissionBtnEdit")}),(0,t.jsx)(l.A,{title:e("pages.system:permissionMsgDeleteConfirm"),onConfirm:()=>_(i.id),okText:e("common:yes"),cancelText:e("common:no"),children:(0,t.jsx)(m.Ay,{type:"link",size:"small",danger:!0,icon:(0,t.jsx)(g.A,{}),children:e("pages.system:permissionBtnDelete")})})]})}],I=e=>{F(e),s.setFieldsValue(e),w(!0)},_=e=>{j(i.filter(s=>s.id!==e))},O=async()=>{try{let e=await s.validateFields();if(k(!0),v)j(i.map(s=>s.id===v.id?{...s,...e}:s));else{let s={id:Date.now().toString(),...e,createdAt:new Date().toISOString().split("T")[0]};j([...i,s])}w(!1),s.resetFields()}catch(e){console.error("Validation failed:",e)}finally{k(!1)}};return(0,t.jsxs)("div",{className:"permission-management",children:[(0,t.jsxs)("div",{className:"permission-management__header",children:[(0,t.jsx)("h2",{children:e("pages.system:permissionTitle")}),(0,t.jsxs)(o.A,{children:[(0,t.jsx)(d.A.Search,{placeholder:e("pages.system:permissionSearchPh"),style:{width:250},onSearch:f,allowClear:!0}),(0,t.jsx)(m.Ay,{type:"primary",icon:(0,t.jsx)(x.A,{}),onClick:()=>{F(null),s.resetFields(),w(!0)},children:e("pages.system:permissionBtnAdd")})]})]}),(0,t.jsx)(p.A,{defaultActiveKey:N.map(e=>e.module),items:N.map(e=>({key:e.module,label:(0,t.jsxs)("div",{className:"permission-management__panel-header",children:[(0,t.jsx)("span",{className:"permission-management__panel-title",children:e.moduleName}),(0,t.jsxs)(n.A,{children:[e.permissions.length," 个权限"]})]}),children:(0,t.jsx)(c.A,{columns:S,dataSource:e.permissions,rowKey:"id",pagination:!1,size:"small",scroll:{x:"max-content"}})}))}),(0,t.jsx)(u.A,{title:v?e("pages.system:permissionModalTitleEdit"):e("pages.system:permissionModalTitleAdd"),open:C,onOk:O,onCancel:()=>w(!1),confirmLoading:b,width:600,children:(0,t.jsxs)(a.A,{form:s,layout:"vertical",children:[(0,t.jsx)(a.A.Item,{name:"code",label:e("pages.system:permissionFormCode"),rules:[{required:!0,message:e("pages.system:permissionFormCodeRequired")},{pattern:/^[a-z:_]+$/,message:e("pages.system:permissionFormCodePattern")}],children:(0,t.jsx)(d.A,{placeholder:e("pages.system:permissionFormCodePh"),disabled:!!v})}),(0,t.jsx)(a.A.Item,{name:"name",label:e("pages.system:permissionFormName"),rules:[{required:!0,message:e("pages.system:permissionFormNameRequired")}],children:(0,t.jsx)(d.A,{placeholder:e("pages.system:permissionFormNamePh")})}),(0,t.jsx)(a.A.Item,{name:"module",label:e("pages.system:permissionFormModule"),rules:[{required:!0,message:e("pages.system:permissionFormModuleRequired")}],children:(0,t.jsxs)(y.A,{placeholder:e("pages.system:permissionFormModulePh"),children:[(0,t.jsx)(y.A.Option,{value:"user",children:"用户管理"}),(0,t.jsx)(y.A.Option,{value:"role",children:"角色管理"}),(0,t.jsx)(y.A.Option,{value:"menu",children:"菜单管理"}),(0,t.jsx)(y.A.Option,{value:"permission",children:"权限管理"})]})}),(0,t.jsx)(a.A.Item,{name:"type",label:e("pages.system:permissionFormType"),rules:[{required:!0}],initialValue:"button",children:(0,t.jsxs)(y.A,{children:[(0,t.jsx)(y.A.Option,{value:"page",children:e("pages.system:permissionTypePage")}),(0,t.jsx)(y.A.Option,{value:"button",children:e("pages.system:permissionTypeButton")}),(0,t.jsx)(y.A.Option,{value:"api",children:e("pages.system:permissionTypeApi")})]})}),(0,t.jsx)(a.A.Item,{name:"description",label:e("pages.system:permissionFormDescription"),children:(0,t.jsx)(d.A.TextArea,{rows:3,placeholder:e("pages.system:permissionFormDescriptionPh")})})]})})]})}}}]);